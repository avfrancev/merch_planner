import{r as h,a as te,o as l,c as k,t as J,b as _,d as i,F as B,e as A,f as D,u as t,n as N,g as P,h as I,w as R,m as E,i as se,_ as re,j as oe,k as ae,l as ne,p as ie,q as T,s as de,v as ce,x as F,y as X,z as ue,A as le,B as ye,C as $,D as pe,E as S,G as ge,H,I as V,J as _e,K as Ce,L as me,M as fe,N as ve,O as be,P as Qe}from"./vendor-CVm7UDDa.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const d of r)if(d.type==="childList")for(const y of d.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&s(y)}).observe(document,{childList:!0,subtree:!0});function a(r){const d={};return r.integrity&&(d.integrity=r.integrity),r.referrerPolicy&&(d.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?d.credentials="include":r.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(r){if(r.ep)return;r.ep=!0;const d=a(r);fetch(r.href,d)}})();const he={__name:"App",setup(o){return h(),(e,a)=>{const s=te("router-view");return l(),k(s)}}},De=i("pre",null,"table view",-1),Le={class:"table table-xs -z-10"},xe=i("td",null,"Store",-1),Ne=i("td",null,"Address",-1),Ie={__name:"DaysTableView",props:{addresses:Array,addressesGroupedByDays:Object,canDrop:Boolean,currDay:Number,colors:Array,days:Array,isDragging:Boolean},setup(o){const e=o,{currDay:a,colors:s,days:r,addressesGroupedByDays:d}=J(e),{addresses:y}=e;return h(!1),h(!0),(p,c)=>(l(),_(B,null,[De,i("table",Le,[i("thead",null,[i("tr",null,[xe,Ne,(l(!0),_(B,null,A(t(r),n=>(l(),_("td",null,D(n),1))),256))])]),i("tbody",null,[(l(!0),_(B,null,A(t(y),(n,L)=>(l(),_("tr",null,[i("td",null,D(n.store),1),i("td",null,D(n.address),1),(l(!0),_(B,null,A(t(r),(f,v)=>(l(),_("td",{onClick:c[0]||(c[0]=()=>{})},D(n.days.includes(v)?"1":""),1))),256))]))),256))])])],64))}},Ge={class:"flex items-baseline justify-between space-x-2 px-4 py-4 border-b-2 border-base-300"},Ye={class:"flex items-center"},ke={class:"font-bold text-xl uppercase"},Be=["id","onPointerleave","onPointerenter","onClick"],we={class:"flex-1"},Ae={__name:"DaysCardView",props:{addresses:Array,addressesGroupedByDays:Object,canDrop:Boolean,currDay:Number,colors:Array,days:Array,isDragging:Boolean},setup(o){const e=o,{currDay:a,colors:s,days:r,addressesGroupedByDays:d}=J(e),{addresses:y}=e,p=h(!1),c=h(!0),n={animation:200,group:"description",disabled:!1,forceFallback:!0,ghostClass:"ghost"};function L(m){const u=m.relatedContext.list,b=m.draggedContext.element;let C=+m.from.dataset.dayId,g=+m.to.dataset.dayId;return c.value=!0,C!==g&&u.includes(b)?(c.value=!1,!1):!0}function f(m,u){p.value=!1;let b=+m.from.dataset.dayId,C=+m.to.dataset.dayId;c.value=!0;let g=y.find(x=>x.iid===m.item.id);if(g){let x=g.days.indexOf(b);g.days[x]=C,v(g)}}function v(m){y.forEach(u=>u.isHovered=!1),p.value||(m.isHovered=!0)}return(m,u)=>(l(),_("div",{class:N(["carousel w-full box-border space-x-4 justify-stretch mt-6 mb-6",[t(c)?"":"no-drop"]])},[(l(!0),_(B,null,A(t(d),(b,C)=>(l(),_("div",{class:N(["carousel-item rounded flex flex-col flex-1 min-w-52 border-2 box-border",[t(a)==C?"border-accent":"border-base-300"]]),style:P({borderColor:t(s)[t(a)==C?t(a):-1]})},[i("div",Ge,[i("div",Ye,[i("div",{class:"inline-block rounded-full h-4 w-4 mr-2",style:P({background:t(s)[C]})},null,4),i("div",ke,D(t(r)[C]),1)]),i("span",null,"Точек: "+D(b.length),1)]),I(t(se),E({class:"my-2 h-full",modelValue:t(d)[C],"onUpdate:modelValue":g=>t(d)[C]=g},n,{itemKey:"address",tag:"ul",move:L,onStart:u[0]||(u[0]=g=>p.value=!0),onEnd:f,"data-day-id":C}),{item:R(({element:g,index:x})=>[i("li",{id:g.iid,ref_for:!0,ref:G=>g.li=G,onPointerleave:G=>g.isHovered=!1,onPointerenter:G=>v(g),onClick:()=>console.log(g)},[i("div",{class:N(["flex p-2 space-x-2 transition rounded mx-2 p-2 select-none",{"bg-neutral":g.isHovered}])},[i("div",{class:"h-4 w-4 rounded-full flex-none",style:P({...g.pieChartStyles})},null,4),i("div",we,D(g.address),1)],2)],40,Be)]),_:2},1040,["modelValue","onUpdate:modelValue","data-day-id"])],6))),256))],2))}},He=["onPointerenter","onPointerleave","onClick"],Pe={class:"hint"},Me={__name:"YaMap",props:{addresses:Array},setup(o){return(e,a)=>(l(),k(t(ie),{settings:{location:{center:[o.addresses[0].x,o.addresses[0].y],zoom:12.3}}},{default:R(()=>[I(t(re)),I(t(oe)),(l(!0),_(B,null,A(o.addresses,(s,r)=>(l(),k(t(ae),{key:r,position:"center left-center",settings:{coordinates:[s.x,s.y],properties:{hint:`${s.address}`}}},{default:R(()=>[i("div",{class:N(["absolute left-1/2 -bottom-2 transform-gpu transition border rounded-full",[s.isHovered?"scale-150 z-10 border-neutral":"scale-100 -z-1 border-transparent"]]),onPointerenter:d=>s.isHovered=!0,onPointerleave:d=>s.isHovered=!1,onClick:d=>s.li.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})},[i("div",{class:N(["h-6 w-6 rounded-full shadow-lg1",[s.isInDay?"opacity-100":"opacity-30"]]),style:P({...s.pieChartStyles,transform:"translate(0%,0%)"})},null,6)],42,He)]),_:2},1032,["settings"]))),128)),I(t(ne),{"hint-property":"hint"},{default:R(({content:s})=>[i("div",Pe,D(s),1)]),_:1})]),_:1},8,["settings"]))}},$e={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Re=i("path",{fill:"currentColor",d:"m12 8l-6 6l1.41 1.41L12 10.83l4.59 4.58L18 14z"},null,-1),Se=[Re];function je(o,e){return l(),_("svg",$e,[...Se])}const ze={name:"ic-outline-expand-less",render:je},Fe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ve=i("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17L7.41 8.59L6 10l6 6l6-6z"},null,-1),Ee=[Ve];function Ke(o,e){return l(),_("svg",Fe,[...Ee])}const qe={name:"ic-outline-expand-more",render:Ke},Oe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Je=i("path",{fill:"currentColor",d:"M3 5v14h18V5zm4 2v2H5V7zm-2 6v-2h2v2zm0 2h2v2H5zm14 2H9v-2h10zm0-4H9v-2h10zm0-4H9V7h10z"},null,-1),Te=[Je];function Xe(o,e){return l(),_("svg",Oe,[...Te])}const Ue={name:"ic-outline-view-list",render:Xe},Ze={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},We=i("path",{fill:"currentColor",d:"M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2M8 18H4V6h4zm6 0h-4V6h4zm6 0h-4V6h4z"},null,-1),et=[We];function tt(o,e){return l(),_("svg",Ze,[...et])}const st={name:"ic-outline-view-week",render:tt},rt=[{id_tt:729340,code_tt:1311,store:"Верный",address:"ул. Профсоюзная, д. 12",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.570123,55.685437]},properties:{name:"Профсоюзная улица, 12",description:"Москва, Россия",boundedBy:[[37.566018,55.683118],[37.574229,55.687756]],uri:"ymapsbm1://geo?data=Cgg1NjY3MTI1MhJB0KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsINCf0YDQvtGE0YHQvtGO0LfQvdCw0Y8g0YPQu9C40YbQsCwgMTIiCg3PRxZCFeO9XkI,",GeocoderMetaData:{precision:"exact",text:"Россия, Москва, Профсоюзная улица, 12",kind:"house"}}},id:0,cluster:4,x:37.570123,y:55.685437,pieChartStyles:{background:"conic-gradient(rgb(35, 171, 216) 0% 100%)"},isInDay:!0,days:[4],iid:"ул. Профсоюзная, д. 12_4",li:{id:"ул. Профсоюзная, д. 12_4","data-draggable":"true"},isHovered:!1},{id_tt:795886,code_tt:77036,store:"Дикси",address:"ул. Ленинская, д. 34",visit_frequency:2,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.646148,55.704621]},properties:{name:"улица Ленинская Слобода, 32",description:"Москва, Россия",boundedBy:[[37.642042,55.702302],[37.650253,55.706939]],uri:"ymapsbm1://geo?data=Cgg1Njg3OTMzMBJM0KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsINGD0LvQuNGG0LAg0JvQtdC90LjQvdGB0LrQsNGPINCh0LvQvtCx0L7QtNCwLCAzMiIKDaeVFkIViNFeQg,,",GeocoderMetaData:{precision:"near",text:"Россия, Москва, улица Ленинская Слобода, 32",kind:"house"}}},id:1,cluster:3,x:37.646148,y:55.704621,pieChartStyles:{background:"conic-gradient(rgb(82, 246, 103) 0% 50%, rgb(254, 75, 131) 50% 100%)"},isInDay:!0,days:[3,1],iid:"ул. Ленинская, д. 34_1",li:{id:"ул. Ленинская, д. 34_1","data-draggable":"true"},isHovered:!1},{id_tt:717543,code_tt:77489,store:"Дикси",address:"пр. Мира, д. 78",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.635161,55.791263]},properties:{name:"проспект Мира, 78",description:"Москва, Россия",boundedBy:[[37.631056,55.78895],[37.639267,55.793576]],uri:"ymapsbm1://geo?data=Cgg1Njc0NjUzOBI50KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsINC_0YDQvtGB0L_QtdC60YIg0JzQuNGA0LAsIDc4IgoNaYoWQhVAKl9C",GeocoderMetaData:{precision:"exact",text:"Россия, Москва, проспект Мира, 78",kind:"house"}}},id:2,cluster:2,x:37.635161,y:55.791263,pieChartStyles:{background:"conic-gradient(rgb(226, 183, 47) 0% 100%)"},isInDay:!0,days:[2],iid:"пр. Мира, д. 78_2",li:{id:"пр. Мира, д. 78_2","data-draggable":"true"},isHovered:!1},{id_tt:717578,code_tt:77069,store:"Дикси",address:"ул. Тверская, д. 56",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.606478,55.763903]},properties:{name:"Тверская улица",description:"Москва, Россия",boundedBy:[[37.596516,55.756933],[37.61547,55.769636]],uri:"ymapsbm1://geo?data=Cgc4MDU5OTE2EjfQoNC-0YHRgdC40Y8sINCc0L7RgdC60LLQsCwg0KLQstC10YDRgdC60LDRjyDRg9C70LjRhtCwIgoNCG0WQhU8Dl9C",GeocoderMetaData:{precision:"street",text:"Россия, Москва, Тверская улица",kind:"street"}}},id:3,cluster:3,x:37.606478,y:55.763903,pieChartStyles:{background:"conic-gradient(rgb(82, 246, 103) 0% 100%)"},isInDay:!0,days:[3],iid:"ул. Тверская, д. 56_3",li:{id:"ул. Тверская, д. 56_3","data-draggable":"true"},isHovered:!1},{id_tt:717675,code_tt:77522,store:"Дикси",address:"ул. Новый Арбат, д. 5",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.598043,55.752597]},properties:{name:"улица Новый Арбат, 5",description:"Москва, Россия",boundedBy:[[37.593938,55.750282],[37.602148,55.754912]],uri:"ymapsbm1://geo?data=Cgg1NjcxNDIwNBI_0KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsINGD0LvQuNGG0LAg0J3QvtCy0YvQuSDQkNGA0LHQsNGCLCA1IgoNZWQWQhWpAl9C",GeocoderMetaData:{precision:"exact",text:"Россия, Москва, улица Новый Арбат, 5",kind:"house"}}},id:4,cluster:3,x:37.598043,y:55.752597,pieChartStyles:{background:"conic-gradient(rgb(82, 246, 103) 0% 100%)"},isInDay:!0,days:[3],iid:"ул. Новый Арбат, д. 5_3",li:{id:"ул. Новый Арбат, д. 5_3","data-draggable":"true"},isHovered:!1},{id_tt:717791,code_tt:77563,store:"Дикси",address:"пр. Ленина, д. 92",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.216591,55.621501]},properties:{name:"улица Ленина, 84с1",description:"посёлок Толстопальцево, Москва, Россия",boundedBy:[[37.212486,55.619178],[37.220697,55.623824]],uri:"ymapsbm1://geo?data=Cgo0MTEwNzc2ODUyEmfQoNC-0YHRgdC40Y8sINCc0L7RgdC60LLQsCwg0L_QvtGB0ZHQu9C-0Log0KLQvtC70YHRgtC-0L_QsNC70YzRhtC10LLQviwg0YPQu9C40YbQsCDQm9C10L3QuNC90LAsIDg00YExIgoNyt0UQhVqfF5C",GeocoderMetaData:{precision:"near",text:"Россия, Москва, посёлок Толстопальцево, улица Ленина, 84с1",kind:"house"}}},id:5,cluster:0,x:37.216591,y:55.621501,pieChartStyles:{background:"conic-gradient(rgb(110, 64, 170) 0% 100%)"},isInDay:!0,days:[0],iid:"пр. Ленина, д. 92_0",li:{id:"пр. Ленина, д. 92_0","data-draggable":"true"},isHovered:!1},{id_tt:717853,code_tt:1311,store:"Лента",address:"ул. Гагарина, д. 20",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.593632,55.49879]},properties:{name:"улица Гагарина, 20",description:"деревня Захарьино, район Южное Бутово, Юго-Западный административный округ, Москва, Россия",boundedBy:[[37.589527,55.49646],[37.597738,55.501121]],uri:"ymapsbm1://geo?data=Cgg1NjYxNzEzMxLHAdCg0L7RgdGB0LjRjywg0JzQvtGB0LrQstCwLCDQrtCz0L4t0JfQsNC_0LDQtNC90YvQuSDQsNC00LzQuNC90LjRgdGC0YDQsNGC0LjQstC90YvQuSDQvtC60YDRg9CzLCDRgNCw0LnQvtC9INCu0LbQvdC-0LUg0JHRg9GC0L7QstC-LCDQtNC10YDQtdCy0L3RjyDQl9Cw0YXQsNGA0YzQuNC90L4sINGD0LvQuNGG0LAg0JPQsNCz0LDRgNC40L3QsCwgMjAiCg3iXxZCFcP-XUI,",GeocoderMetaData:{precision:"exact",text:"Россия, Москва, Юго-Западный административный округ, район Южное Бутово, деревня Захарьино, улица Гагарина, 20",kind:"house"}}},id:6,cluster:4,x:37.593632,y:55.49879,pieChartStyles:{background:"conic-gradient(rgb(35, 171, 216) 0% 100%)"},isInDay:!0,days:[4],iid:"ул. Гагарина, д. 20_4",li:{id:"ул. Гагарина, д. 20_4","data-draggable":"true"},isHovered:!1},{id_tt:717857,code_tt:1338,store:"Лента",address:"ул. Кутузовская, д. 42",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.325341,55.701405]},properties:{name:"Кутузовская улица",description:"микрорайон Новая Трёхгорка, Одинцово, Московская область, Россия",boundedBy:[[37.324012,55.697376],[37.327578,55.705037]],uri:"ymapsbm1://geo?data=CggxMDA0ODc4OBKaAdCg0L7RgdGB0LjRjywg0JzQvtGB0LrQvtCy0YHQutCw0Y8g0L7QsdC70LDRgdGC0YwsINCe0LTQuNC90YbQvtCy0L4sINC80LjQutGA0L7RgNCw0LnQvtC9INCd0L7QstCw0Y8g0KLRgNGR0YXQs9C-0YDQutCwLCDQmtGD0YLRg9C30L7QstGB0LrQsNGPINGD0LvQuNGG0LAiCg0nTRVCFT3OXkI,",GeocoderMetaData:{precision:"street",text:"Россия, Московская область, Одинцово, микрорайон Новая Трёхгорка, Кутузовская улица",kind:"street"}}},id:7,cluster:0,x:37.325341,y:55.701405,pieChartStyles:{background:"conic-gradient(rgb(110, 64, 170) 0% 100%)"},isInDay:!0,days:[0],iid:"ул. Кутузовская, д. 42_0",li:{id:"ул. Кутузовская, д. 42_0","data-draggable":"true"},isHovered:!1},{id_tt:806979,code_tt:6833,store:"Пятерочка",address:"пр. Проспект Мира, д. 17",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.631865,55.777626]},properties:{name:"проспект Мира, 17",description:"Москва, Россия",boundedBy:[[37.627759,55.775312],[37.63597,55.77994]],uri:"ymapsbm1://geo?data=Cgg1NjczNTg0NxI50KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsINC_0YDQvtGB0L_QtdC60YIg0JzQuNGA0LAsIDE3IgoNB4cWQhVLHF9C",GeocoderMetaData:{precision:"exact",text:"Россия, Москва, проспект Мира, 17",kind:"house"}}},id:8,cluster:2,x:37.631865,y:55.777626,pieChartStyles:{background:"conic-gradient(rgb(226, 183, 47) 0% 100%)"},isInDay:!0,days:[2],iid:"пр. Проспект Мира, д. 17_2",li:{id:"пр. Проспект Мира, д. 17_2","data-draggable":"true"},isHovered:!1},{id_tt:729346,code_tt:5147,store:"Пятерочка",address:"ул. Садовая-Кудринская, д. 30",visit_frequency:2,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.58985,55.764592]},properties:{name:"Садовая-Кудринская улица, 28-30",description:"Москва, Россия",boundedBy:[[37.585745,55.762277],[37.593956,55.766906]],uri:"ymapsbm1://geo?data=Cgg1NjcyNTUxNhJR0KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsINCh0LDQtNC-0LLQsNGPLdCa0YPQtNGA0LjQvdGB0LrQsNGPINGD0LvQuNGG0LAsIDI4LTMwIgoNAVwWQhXxDl9C",GeocoderMetaData:{precision:"near",text:"Россия, Москва, Садовая-Кудринская улица, 28-30",kind:"house"}}},id:9,cluster:3,x:37.58985,y:55.764592,pieChartStyles:{background:"conic-gradient(rgb(82, 246, 103) 0% 50%, rgb(254, 75, 131) 50% 100%)"},isInDay:!0,days:[3,1],iid:"ул. Садовая-Кудринская, д. 30_1",li:{id:"ул. Садовая-Кудринская, д. 30_1","data-draggable":"true"},isHovered:!1},{id_tt:806987,code_tt:"31BJ",store:"Пятерочка",address:"ул. Тверская-Ямская, д. 8",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.593435,55.771899]},properties:{name:"1-я Тверская-Ямская улица, 8",description:"Москва, Россия",boundedBy:[[37.589329,55.769585],[37.59754,55.774213]],uri:"ymapsbm1://geo?data=Cgg1NjczMTc5NRJM0KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsIDEt0Y8g0KLQstC10YDRgdC60LDRjy3Qr9C80YHQutCw0Y8g0YPQu9C40YbQsCwgOCIKDa1fFkIVbRZfQg,,",GeocoderMetaData:{precision:"exact",text:"Россия, Москва, 1-я Тверская-Ямская улица, 8",kind:"house"}}},id:10,cluster:3,x:37.593435,y:55.771899,pieChartStyles:{background:"conic-gradient(rgb(82, 246, 103) 0% 100%)"},isInDay:!0,days:[3],iid:"ул. Тверская-Ямская, д. 8_3",li:{id:"ул. Тверская-Ямская, д. 8_3","data-draggable":"true"},isHovered:!1},{id_tt:718138,code_tt:"G560",store:"Пятерочка",address:"пр. Пресненская набережная, д. 14",visit_frequency:2,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.537434,55.749633]},properties:{name:"Пресненская набережная, 12",description:"Москва, Россия",boundedBy:[[37.533328,55.747317],[37.541539,55.751948]],uri:"ymapsbm1://geo?data=CgoxNzQ4OTk0ODY4EkvQoNC-0YHRgdC40Y8sINCc0L7RgdC60LLQsCwg0J_RgNC10YHQvdC10L3RgdC60LDRjyDQvdCw0LHQtdGA0LXQttC90LDRjywgMTIiCg1VJhZCFZ__XkI,",GeocoderMetaData:{precision:"near",text:"Россия, Москва, Пресненская набережная, 12",kind:"house"}}},id:11,cluster:3,x:37.537434,y:55.749633,pieChartStyles:{background:"conic-gradient(rgb(82, 246, 103) 0% 50%, rgb(254, 75, 131) 50% 100%)"},isInDay:!0,days:[3,1],iid:"пр. Пресненская набережная, д. 14_1",li:{id:"пр. Пресненская набережная, д. 14_1","data-draggable":"true"},isHovered:!1},{id_tt:718215,code_tt:5219,store:"Пятерочка",address:"ул. Кировоградская, д. 19",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.601978,55.60427]},properties:{name:"Кировоградская улица, 19к2",description:"Москва, Россия",boundedBy:[[37.597872,55.601945],[37.606083,55.606594]],uri:"ymapsbm1://geo?data=Cgg1NjYzNjc2MRJK0KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsINCa0LjRgNC-0LLQvtCz0YDQsNC00YHQutCw0Y8g0YPQu9C40YbQsCwgMTnQujIiCg1taBZCFcVqXkI,",GeocoderMetaData:{precision:"number",text:"Россия, Москва, Кировоградская улица, 19к2",kind:"house"}}},id:12,cluster:4,x:37.601978,y:55.60427,pieChartStyles:{background:"conic-gradient(rgb(35, 171, 216) 0% 100%)"},isInDay:!0,days:[4],iid:"ул. Кировоградская, д. 19_4",li:{id:"ул. Кировоградская, д. 19_4","data-draggable":"true"},isHovered:!1},{id_tt:718226,code_tt:3595,store:"Пятерочка",address:"пр. Вернадского, д. 61",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.501654,55.672433]},properties:{name:"проспект Вернадского, 61",description:"Москва, Россия",boundedBy:[[37.497548,55.670112],[37.505759,55.674753]],uri:"ymapsbm1://geo?data=CgoxNDg4OTg0NzY3EkfQoNC-0YHRgdC40Y8sINCc0L7RgdC60LLQsCwg0L_RgNC-0YHQv9C10LrRgiDQktC10YDQvdCw0LTRgdC60L7Qs9C-LCA2MSIKDbEBFkIVk7BeQg,,",GeocoderMetaData:{precision:"exact",text:"Россия, Москва, проспект Вернадского, 61",kind:"house"}}},id:13,cluster:4,x:37.501654,y:55.672433,pieChartStyles:{background:"conic-gradient(rgb(35, 171, 216) 0% 100%)"},isInDay:!0,days:[4],iid:"пр. Вернадского, д. 61_4",li:{id:"пр. Вернадского, д. 61_4","data-draggable":"true"},isHovered:!1},{id_tt:718227,code_tt:"358F",store:"Пятерочка",address:"ул. Новый Арбат, д. 41",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.576133,55.752004]},properties:{name:"улица Новый Арбат, 31/12",description:"Москва, Россия",boundedBy:[[37.572028,55.749689],[37.580238,55.754319]],uri:"ymapsbm1://geo?data=Cgg1NjcxMzQxNhJD0KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsINGD0LvQuNGG0LAg0J3QvtCy0YvQuSDQkNGA0LHQsNGCLCAzMS8xMiIKDfZNFkIVDQJfQg,,",GeocoderMetaData:{precision:"near",text:"Россия, Москва, улица Новый Арбат, 31/12",kind:"house"}}},id:14,cluster:3,x:37.576133,y:55.752004,pieChartStyles:{background:"conic-gradient(rgb(82, 246, 103) 0% 100%)"},isInDay:!0,days:[3],iid:"ул. Новый Арбат, д. 41_3",li:{id:"ул. Новый Арбат, д. 41_3","data-draggable":"true"},isHovered:!1},{id_tt:718228,code_tt:"395Q",store:"Пятерочка",address:"ул. Зеленый проспект, д. 25",visit_frequency:2,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.787031,55.75207]},properties:{name:"Зелёный проспект, 25к1",description:"Москва, Россия",boundedBy:[[37.782925,55.749755],[37.791136,55.754385]],uri:"ymapsbm1://geo?data=Cgg1NjcxMjIyMhJC0KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsINCX0LXQu9GR0L3Ri9C5INC_0YDQvtGB0L_QtdC60YIsIDI10LoxIgoN7CUXQhUfAl9C",GeocoderMetaData:{precision:"number",text:"Россия, Москва, Зелёный проспект, 25к1",kind:"house"}}},id:15,cluster:1,x:37.787031,y:55.75207,pieChartStyles:{background:"conic-gradient(rgb(226, 183, 47) 0% 50%, rgb(254, 75, 131) 50% 100%)"},isInDay:!0,days:[2,1],iid:"ул. Зеленый проспект, д. 25_1",li:{id:"ул. Зеленый проспект, д. 25_1","data-draggable":"true"},isHovered:!1},{id_tt:718256,code_tt:"Y227",store:"Пятерочка",address:"пр. Ленинградский проспект, д. 73",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.514401,55.804476]},properties:{name:"Ленинградский проспект, 73",description:"Москва, Россия",boundedBy:[[37.510296,55.802163],[37.518506,55.806788]],uri:"ymapsbm1://geo?data=Cgg1Njc1NzIzMBJL0KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsINCb0LXQvdC40L3Qs9GA0LDQtNGB0LrQuNC5INC_0YDQvtGB0L_QtdC60YIsIDczIgoNvw4WQhXIN19C",GeocoderMetaData:{precision:"exact",text:"Россия, Москва, Ленинградский проспект, 73",kind:"house"}}},id:16,cluster:3,x:37.514401,y:55.804476,pieChartStyles:{background:"conic-gradient(rgb(82, 246, 103) 0% 100%)"},isInDay:!0,days:[3],iid:"пр. Ленинградский проспект, д. 73_3",li:{id:"пр. Ленинградский проспект, д. 73_3","data-draggable":"true"},isHovered:!1},{id_tt:718257,code_tt:6885,store:"Пятерочка",address:"ул. Большая Якиманка, д. 39",visit_frequency:2,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.613296,55.733852]},properties:{name:"улица Большая Якиманка, 39",description:"Москва, Россия",boundedBy:[[37.609191,55.731536],[37.617402,55.736169]],uri:"ymapsbm1://geo?data=Cgg1NjY5NzUxNBJK0KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsINGD0LvQuNGG0LAg0JHQvtC70YzRiNCw0Y8g0K_QutC40LzQsNC90LrQsCwgMzkiCg0DdBZCFXfvXkI,",GeocoderMetaData:{precision:"exact",text:"Россия, Москва, улица Большая Якиманка, 39",kind:"house"}}},id:17,cluster:3,x:37.613296,y:55.733852,pieChartStyles:{background:"conic-gradient(rgb(82, 246, 103) 0% 50%, rgb(254, 75, 131) 50% 100%)"},isInDay:!0,days:[3,1],iid:"ул. Большая Якиманка, д. 39_1",li:{id:"ул. Большая Якиманка, д. 39_1","data-draggable":"true"},isHovered:!1},{id_tt:718283,code_tt:3950,store:"Пятерочка",address:"ул. Малая Бронная, д. 10",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.596696,55.760677]},properties:{name:"Малая Бронная улица, 10с1",description:"Москва, Россия",boundedBy:[[37.59259,55.758362],[37.600801,55.762991]],uri:"ymapsbm1://geo?data=Cgg1NjcyMTQzNxJH0KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsINCc0LDQu9Cw0Y8g0JHRgNC-0L3QvdCw0Y8g0YPQu9C40YbQsCwgMTDRgTEiCg0EYxZCFe4KX0I,",GeocoderMetaData:{precision:"exact",text:"Россия, Москва, Малая Бронная улица, 10с1",kind:"house"}}},id:18,cluster:3,x:37.596696,y:55.760677,pieChartStyles:{background:"conic-gradient(rgb(82, 246, 103) 0% 100%)"},isInDay:!0,days:[3],iid:"ул. Малая Бронная, д. 10_3",li:{id:"ул. Малая Бронная, д. 10_3","data-draggable":"true"},isHovered:!1},{id_tt:718284,code_tt:"302H",store:"Пятерочка",address:"пр. Мира, д. 104",visit_frequency:1,ya:{type:"Feature",geometry:{type:"Point",coordinates:[37.636886,55.802153]},properties:{name:"проспект Мира, 104",description:"Москва, Россия",boundedBy:[[37.632781,55.799841],[37.640991,55.804466]],uri:"ymapsbm1://geo?data=Cgg1Njc1NDMwMBI60KDQvtGB0YHQuNGPLCDQnNC-0YHQutCy0LAsINC_0YDQvtGB0L_QtdC60YIg0JzQuNGA0LAsIDEwNCIKDS2MFkIVZzVfQg,,",GeocoderMetaData:{precision:"exact",text:"Россия, Москва, проспект Мира, 104",kind:"house"}}},id:19,cluster:2,x:37.636886,y:55.802153,pieChartStyles:{background:"conic-gradient(rgb(226, 183, 47) 0% 100%)"},isInDay:!0,days:[2],iid:"пр. Мира, д. 104_2",li:{id:"пр. Мира, д. 104_2","data-draggable":"true"},isHovered:!1}],ot=(o,e)=>Math.sqrt((o.x-e.x)**2+(o.y-e.y)**2),O=o=>o.reduce((e,a)=>e+a,0)/o.length,at=(o,e)=>{const a=e.map(r=>ot(o,r));return a.findIndex(r=>r===Math.min(...a))};function nt(o,e){let a=o.slice(0,e).map(y=>({x:y.x,y:y.y})),s=!0,r=0;const d=100;for(;s&&r<d;)s=!1,r++,o.forEach(y=>{const p=at(y,a);y.cluster!==p&&(s=!0,y.cluster=p)}),a=a.map((y,p)=>{const c=o.filter(n=>n.cluster===p);return c.length===0?a[p]:{x:O(c.map(n=>n.x)),y:O(c.map(n=>n.y))}});return{centroids:a}}function it(o){o.forEach(e=>{e.days=[];let a=e.visit_frequency,s=e.cluster;e.days.push(s);let y=ue(o,p=>p.cluster).sort((p,c)=>p[1].length-c[1].length)[0][0];for(let p=1;p<a;p++)e.days.includes(y%5)?e.days.push(++y%5):e.days.push(y%5)})}function dt(o){return o.reduce((e,a)=>{let s=a.days;return s.forEach((r,d)=>{e[r]||(e[r]=[]),a.iid=`${a.address}_${s[d]}`,e[r].push(a)}),e},{})}const U=T("addresses",()=>{const o=["Пн","Вт","Ср","Чт","Пт"],e=Array.from(Array(5)).map((c,n)=>de(n/5)),a=h(-1),s=ce([]),r=h([]),d=h([]);function y(c){s.splice(0,s.length,...c),s.forEach((n,L)=>{n.id=L,n.cluster=0,n.x=F(()=>{var f,v,m,u,b;return((f=n.ya.features)==null?void 0:f.length)>0?(m=(v=n.ya)==null?void 0:v.features[0].geometry)==null?void 0:m.coordinates[0]:((b=(u=n.ya)==null?void 0:u.geometry)==null?void 0:b.coordinates[0])||0}),n.y=F(()=>{var f,v,m,u,b,C;return((v=(f=n.ya)==null?void 0:f.features)==null?void 0:v.length)>0?(u=(m=n.ya)==null?void 0:m.features[0].geometry)==null?void 0:u.coordinates[1]:((C=(b=n.ya)==null?void 0:b.geometry)==null?void 0:C.coordinates[1])||0}),n.pieChartStyles=F(()=>{if(!n.days)return null;const f=n.days.sort((m,u)=>u-m).length;return{background:`conic-gradient(${n.days.map((m,u)=>{const b=e[m%e.length],C=100/f,g=C*u,x=g+C;return`${b} ${g}% ${x}%`}).join(", ")})`}}),n.isInDay=X(()=>{var f;return((f=n.days)==null?void 0:f.includes(a.value))||a.value===-1})}),r.value=nt(s,5).centroids,it(s),d.value=dt(s)}function p(){y(rt)}return{days:o,colors:e,currDay:a,addresses:s,updateAddresses:y,loadSampleData:p,centroids:r,addressesGroupedByDays:d}});var Z={BASE_URL:"/merch_planner/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const ct=Z.VITE_YAAPI;console.log({apiKey2:ct});async function ut(o){const a=`https://search-maps.yandex.ru/v1/?type=geo&lang=Ru_RU&apikey=${Z.VITE_YAAPI}&text=${o}`;try{const r=await(await fetch(a)).json();return r.statusCode!==200?{error:r.error}:r}catch(s){return{error:s}}}const lt=async o=>{let e=await ut(`Москва, ${o.address}`);return e.error?{error:e.error}:e.features[0]};function yt(o){const e=["ID ТТ","Код ТТ","Сеть","Адрес","План"],a=["id_tt","code_tt","store","address","visit_frequency"];return o.filter(d=>d["ID ТТ"]>0).map(d=>{const y={};for(const[p,c]of Object.entries(d))e.includes(p)&&(y[a[e.indexOf(p)]]=c);return y})}const W=T("file",()=>{const o=U(),{addresses:e,loadSampleData:a,colors:s,days:r,centroids:d,updateAddresses:y}=o,p=h(null),c=h(null),n=h(0),L=X(()=>n.value>0),{files:f,open:v,reset:m,onChange:u}=le({accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",directory:!1});u(C=>{p.value=C[0];const g=new FileReader;g.onload=async x=>{const G=x.target.result,M=ye(G,{type:"binary"}),j=M.Sheets[M.SheetNames[0]],z=$.sheet_to_json(j);let Q=yt(z),Y=Q.length;for(const[K,q]of Q.entries())try{let w=await lt(q);if(w.error){c.value=w.error;break}q.ya=w,n.value=(K+1)/Y*100}catch(w){w.value=w;break}n.value=0,!c.value&&y(Q)},g.readAsBinaryString(p.value)});function b(){const C=$.book_new(),g=$.json_to_sheet(e);$.book_append_sheet(C,g,"Sheet1"),pe(C,"addresses.xlsx")}return{file:p,open:v,parseProgress:n,isLoading:L,exportFile:b,error:c}}),pt={key:0,class:"text-error"},gt={key:1,class:"file flex items-center"},_t=["value"],Ct={key:1,class:"flex items-center space-x-2"},mt={__name:"FileInput",setup(o){const e=W();return(a,s)=>t(e).error?(l(),_("div",pt,D(t(e).error),1)):(l(),_("div",gt,[t(e).isLoading?(l(),_("progress",{key:0,class:"progress w-56",value:t(e).parseProgress,max:"100"},null,8,_t)):(l(),_("div",Ct,[i("button",{class:"btn",onClick:s[0]||(s[0]=(...r)=>t(e).open&&t(e).open(...r))},"Choose file"),t(e).file?(l(),_("span",{key:0,onClick:s[1]||(s[1]=(...r)=>a.open&&a.open(...r))},D(t(e).file.name||""),1)):S("",!0)]))]))}},ft=(o,e)=>{const a=o.__vccOpts||o;for(const[s,r]of e)a[s]=r;return a},ee=o=>(_e("data-v-5cd3723c"),o=o(),Ce(),o),vt={key:0,class:"relative h-full"},bt={class:"flex items-center justify-center h-full flex flex-col"},Qt=ee(()=>i("div",{class:"divider"},"OR",-1)),ht={key:1,class:"container mx-auto px-2 text-xs"},Dt={class:"flex space-x-4 my-4 justify-stretch carousel",id:"top"},Lt={key:0,class:"carousel-item space-x-4"},xt=ee(()=>i("div",{class:"flex-1"},null,-1)),Nt={class:"carousel-item join ml-auto"},It=["onClick"],Gt={class:"carousel-item join"},Yt={class:"relative grid"},kt={__name:"index",setup(o){const e=U(),{addresses:a,loadSampleData:s,colors:r,days:d,centroids:y,updateAddresses:p}=e,{currDay:c,addressesGroupedByDays:n}=ge(e),L=W(),f=h(!1),v=h(!0);return(m,u)=>{const b=mt,C=st,g=Ue,x=qe,G=ze,M=Me,j=Ae,z=Ie;return t(a).length<=0?(l(),_("div",vt,[i("div",bt,[i("button",{class:"btn btn-primary",onClick:u[0]||(u[0]=(...Q)=>t(s)&&t(s)(...Q))},"loadSampleData"),Qt,I(b,H(V({updateAddresses:t(p),addresses:t(a)})),null,16)])])):(l(),_("div",ht,[i("div",Dt,[t(L).error?S("",!0):(l(),_("div",Lt,[I(b,H(V({updateAddresses:t(p),addresses:t(a)})),null,16),i("button",{class:"btn btn-secondary",onClick:u[1]||(u[1]=(...Q)=>t(L).exportFile&&t(L).exportFile(...Q))},"Export")])),xt,i("div",Nt,[i("button",{class:N(["join-item btn",[t(c)===-1?"btn-active":""]]),onClick:u[2]||(u[2]=Q=>c.value=-1)},"Все",2),(l(!0),_(B,null,A(t(d),(Q,Y)=>(l(),_("button",{class:N(["join-item btn",[t(c)===Y?"btn-active":""]]),style:P(`background: ${t(c)===Y?t(r)[Y]:""}; color: ${t(c)===Y?"black":"white"}`),onClick:K=>c.value=Y},D(Q),15,It))),256))]),i("div",Gt,[i("button",{class:N(["join-item btn btn-square",[t(v)?"btn-active btn-secondary":""]]),onClick:u[3]||(u[3]=Q=>v.value=!0)},[I(C,{class:"text-2xl"})],2),i("button",{class:N(["join-item btn btn-square",[t(v)?"":"btn-active btn-secondary"]]),onClick:u[4]||(u[4]=Q=>v.value=!1)},[I(g,{class:"text-2xl"})],2)]),i("button",{class:"carousel-item btn btn-square",onClick:u[5]||(u[5]=Q=>f.value=!t(f))},[t(f)?S("",!0):(l(),k(x,{key:0,class:"text-2xl"})),t(f)?(l(),k(G,{key:1,class:"text-2xl"})):S("",!0)])]),i("div",Yt,[i("div",{class:N(["w-full rounded overflow-hidden sticky top-0",[t(f)?"h-[90svh]":"h-[40svh]"]])},[I(M,H(V({addresses:t(a)})),null,16)],2),t(v)?(l(),k(j,H(E({key:0},{addresses:t(a),currDay:t(c),colors:t(r),days:t(d),addressesGroupedByDays:t(n)})),null,16)):(l(),k(z,H(E({key:1},{addresses:t(a),currDay:t(c),colors:t(r),days:t(d),addressesGroupedByDays:t(n)})),null,16))])]))}}},Bt=ft(kt,[["__scopeId","data-v-5cd3723c"]]),wt=[{name:"index",path:"/",component:Bt,props:!0}],At=me(),Ht=fe({history:ve("/merch_planner/"),routes:wt});be(he).use(Ht).use(At).use(Qe({apikey:"a0212be8-caa5-4f01-8dc3-9ec59a4348bb"})).mount("#app");
